(this.webpackJsonptest2=this.webpackJsonptest2||[]).push([[0],{16:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var r=n(2),i=n(3),c=n.n(i),a=n(9),o=n.n(a),s=(n(16),n(10)),u=n(6),l=n(0),d=n(1),f=n(8),y=f.a.generator(),b=function(e,t,n,r,i,c){return{id:e,x1:t,y1:n,x2:r,y2:i,type:c,roughElement:"line"===c?y.line(t,n,r,i):y.rectangle(t,n,r-t,i-n)}},x=function(e,t,n,r,i){return Math.abs(e-n)<5&&Math.abs(t-r)<5?i:null},j=function(e,t,n){var r=n.type,i=n.x1,c=n.x2,a=n.y1,o=n.y2;if("rectangle"===r){var s=x(e,t,i,a,"tl"),u=x(e,t,c,a,"tr"),l=x(e,t,i,o,"bl"),d=x(e,t,c,o,"br");return s||u||l||d||(e>=i&&e<=c&&t>=a&&t<=o?"inside":null)}var f={x:i,y:a},y={x:c,y:o},b={x:e,y:t},j=h(f,y)-(h(f,b)+h(y,b)),v=x(e,t,i,a,"start"),O=x(e,t,c,o,"end"),g=Math.abs(j)<1?"inside":null;return v||O||g},h=function(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},v=function(e,t,n){return n.map((function(n){return Object(u.a)(Object(u.a)({},n),{},{position:j(e,t,n)})})).find((function(e){return null!==e.position}))},O=function(){var e=function(e){var t=Object(i.useState)(0),n=Object(d.a)(t,2),r=n[0],c=n[1],a=Object(i.useState)([e]),o=Object(d.a)(a,2),s=o[0],u=o[1];return[s[r],function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="function"===typeof e?e(s[r]):e;if(t){var i=Object(l.a)(s);i[r]=n,u(i)}else{var a=Object(l.a)(s).slice(0,r+1);u([].concat(Object(l.a)(a),[n])),c((function(e){return e+1}))}},function(){return r>0&&c((function(e){return e-1}))},function(){return r<s.length-1&&c((function(e){return e+1}))}]}([]),t=Object(d.a)(e,4),n=t[0],c=t[1],a=t[2],o=t[3],y=Object(i.useState)("none"),x=Object(d.a)(y,2),j=x[0],h=x[1],O=Object(i.useState)("line"),g=Object(d.a)(O,2),p=g[0],m=g[1],w=Object(i.useState)(null),M=Object(d.a)(w,2),k=M[0],E=M[1];Object(i.useLayoutEffect)((function(){var e=document.getElementById("canvas");e.getContext("2d").clearRect(0,0,e.width,e.height);var t=f.a.canvas(e);n.forEach((function(e){var n=e.roughElement;return t.draw(n)}))}),[n]),Object(i.useEffect)((function(){var e=function(e){(e.metaKey||e.ctrlKey)&&"z"===e.key&&(e.shiftKey?o():a())};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[a,o]);var S=function(e,t,r,i,a,o){var s=b(e,t,r,i,a,o),u=Object(l.a)(n);u[e]=s,c(u,!0)};return Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{style:{position:"fixed"},children:[Object(r.jsx)("input",{type:"radio",id:"select",checked:"select"===p,onChange:function(){return m("select")}}),Object(r.jsx)("label",{htmlFor:"select",children:"Select"}),Object(r.jsx)("input",{type:"radio",id:"line",checked:"line"===p,onChange:function(){return m("line")}}),Object(r.jsx)("label",{htmlFor:"line",children:"Line"}),Object(r.jsx)("input",{type:"radio",id:"rectangle",checked:"rectangle"===p,onChange:function(){return m("rectangle")}}),Object(r.jsx)("label",{htmlFor:"rectangle",children:"Rectangle"})]}),Object(r.jsxs)("div",{style:{position:"fixed",bottom:0,padding:10},children:[Object(r.jsx)("button",{onClick:a,children:"Undo"}),Object(r.jsx)("button",{onClick:o,children:"Redo"})]}),Object(r.jsx)("canvas",{id:"canvas",height:window.innerHeight,width:window.innerWidth,onMouseDown:function(e){var t=e.clientX,r=e.clientY;if("select"===p){var i=v(t,r,n);if(i){var a=t-i.x1,o=r-i.y1;E(Object(u.a)(Object(u.a)({},i),{},{offsetX:a,offsetY:o})),c((function(e){return e})),"inside"===i.position?h("moving"):h("resizing")}}else{var s=n.length;h("drawing");var d=b(s,t,r,t,r,p);c((function(e){return[].concat(Object(l.a)(e),[d])}))}},onMouseMove:function(e){var t=e.clientX,r=e.clientY;if("select"===p){var i=v(t,r,n);e.target.style.cursor=i?function(e){switch(e){case"tl":case"br":case"start":case"end":return"nwse-resize";case"tr":case"bl":return"nesw-resize";default:return"move"}}(i.position):"default"}if("drawing"===j){var c=n.length-1,a=n[c],o=a.x1,u=a.y1;S(c,o,u,t,r,p)}else if("moving"===j){var l=k.id,d=k.x1,f=k.x2,y=k.y1,b=k.y2,x=k.type,h=t-k.offsetX,O=r-k.offsetY;S(l,h,O,h+(f-d),O+(b-y),x)}else if("resizing"===j){var g=k.id,m=k.type,w=function(e,t,n,r){var i=r.x1,c=r.y1,a=r.x2,o=r.y2;switch(n){case"tl":case"start":return{x1:e,y1:t,x2:a,y2:o};case"tr":return{x1:i,y1:t,x2:e,y2:o};case"bl":return{x1:e,y1:c,x2:a,y2:t};case"br":case"end":return{x1:i,y1:c,x2:e,y2:t};default:return null}}(t,r,k.position,Object(s.a)(k,["id","type","position"])),M=w.x1,E=w.y1,z=w.x2,C=w.y2;S(g,M,E,z,C,m)}},onMouseUp:function(e){if(k){var t=k.id,r=n[t],i=r.id,c=r.type;if("drawing"===j||"resizing"===j){var a=function(e){var t=e.type,n=e.x1,r=e.y1,i=e.x2,c=e.y2;if("rectangle"===t){var a=Math.min(n,i),o=Math.max(n,i);return{x1:a,y1:Math.min(r,c),x2:o,y2:Math.max(r,c)}}return n<i||n===i&&r<c?{x1:n,y1:r,x2:i,y2:c}:{x1:i,y1:c,x2:n,y2:r}}(n[t]),o=a.x1,s=a.y1,u=a.x2,l=a.y2;S(i,o,s,u,l,c)}}h("none"),E(null)},children:"canvas"})]})};o.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(O,{})}),document.getElementById("root"))}},[[17,1,2]]]);
//# sourceMappingURL=main.f608594e.chunk.js.map